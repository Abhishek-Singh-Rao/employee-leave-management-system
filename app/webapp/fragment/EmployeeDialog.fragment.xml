<core:FragmentDefinition
    xmlns="sap.m"
    xmlns:core="sap.ui.core"
    xmlns:f="sap.ui.layout.form">

    <Dialog 
        title="{dialog>/title}"
        contentWidth="600px"
        contentHeight="auto"
        draggable="true"
        resizable="true">
        
        <content>
            <VBox class="sapUiMediumMargin">
                
                <!-- Form -->
                <f:SimpleForm
                    editable="true"
                    layout="ResponsiveGridLayout"
                    labelSpanXL="4"
                    labelSpanL="4"
                    labelSpanM="4"
                    labelSpanS="12"
                    adjustLabelSpan="false"
                    emptySpanXL="0"
                    emptySpanL="0"
                    emptySpanM="0"
                    emptySpanS="0"
                    columnsXL="1"
                    columnsL="1"
                    columnsM="1"
                    singleContainerFullSize="false">
                    
                    <f:content>
                        <!-- Employee ID -->
                        <Label text="Employee ID" required="true"/>
                        <Input 
                            value="{dialog>/employee/empId}"
                            enabled="{= ${dialog>/editMode} === true ? false : true}"
                            placeholder="e.g. E001"
                            maxLength="10"
                            required="true"
                            valueState="{= ${dialog>/employee/empId} ? 'None' : 'Error'}"
                            valueStateText="Employee ID is required"/>
                        
                        <!-- Name -->
                        <Label text="Full Name" required="true"/>
                        <Input 
                            value="{dialog>/employee/name}"
                            placeholder="Enter full name"
                            maxLength="100"
                            required="true"
                            valueState="{= ${dialog>/employee/name} ? 'None' : 'Error'}"
                            valueStateText="Name is required"/>
                        
                        <!-- Email -->
                        <Label text="Email Address" required="true"/>
                        <Input 
                            value="{dialog>/employee/email}"
                            placeholder="name@company.com"
                            type="Email"
                            maxLength="100"
                            required="true"
                            valueState="{= ${dialog>/employee/email} ? 'None' : 'Error'}"
                            valueStateText="Valid email is required"/>
                        
                        <!-- Manager -->
                        <Label text="Manager"/>
                        <ComboBox 
                            id="managerCombo"
                            selectedKey="{dialog>/employee/managerId}"
                            placeholder="Select a manager (optional)"
                            items="{/Managers}"
                            selectionChange=".onManagerChange">
                            <items>
                                <core:Item key="{ID}" text="{name}"/>
                            </items>
                        </ComboBox>
                        
                        <!-- Leave Balance -->
                        <Label text="Leave Balance (days)"/>
                        <StepInput 
                            value="{dialog>/employee/leaveBalance}"
                            min="0"
                            max="50"
                            step="1"
                            displayValuePrecision="0"
                            width="200px"/>
                    </f:content>
                </f:SimpleForm>

                <!-- Validation Messages -->
                <MessageStrip 
                    text="Please fill in all required fields (Employee ID, Name, and Email)"
                    type="Warning"
                    showIcon="true"
                    class="sapUiMediumMarginTop"
                    visible="{= (${dialog>/employee/empId} === '' || ${dialog>/employee/empId} === undefined || ${dialog>/employee/name} === '' || ${dialog>/employee/name} === undefined || ${dialog>/employee/email} === '' || ${dialog>/employee/email} === undefined) ? true : false}"/>

                <!-- Info Message -->
                <MessageStrip 
                    text="Default leave balance for new employees is 20 days. Employee ID cannot be changed after creation."
                    type="Information"
                    showIcon="true"
                    class="sapUiSmallMarginTop"
                    visible="{= ${dialog>/editMode} === false ? true : false}"/>

            </VBox>
        </content>
        
        <beginButton>
            <Button 
                text="{= ${dialog>/editMode} === true ? 'Update' : 'Create'}"
                type="Emphasized"
                icon="{= ${dialog>/editMode} === true ? 'sap-icon://save' : 'sap-icon://add'}"
                press=".onSaveEmployee"
                enabled="{= (${dialog>/employee/empId} !== '' &amp;&amp; ${dialog>/employee/empId} !== undefined &amp;&amp; ${dialog>/employee/name} !== '' &amp;&amp; ${dialog>/employee/name} !== undefined &amp;&amp; ${dialog>/employee/email} !== '' &amp;&amp; ${dialog>/employee/email} !== undefined) ? true : false}"/>
        </beginButton>
        
        <endButton>
            <Button 
                text="Cancel" 
                press=".onCancelEmployee"/>
        </endButton>
        
    </Dialog>

</core:FragmentDefinition>